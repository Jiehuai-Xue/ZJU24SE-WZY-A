{"version":3,"file":"VaFileUploadGalleryItem.vue_vue_type_script_setup_true_lang.js","sources":["../../../../../../src/components/va-file-upload/VaFileUploadGalleryItem/VaFileUploadGalleryItem.vue"],"sourcesContent":["<template>\n  <va-list-item\n    class=\"va-file-upload-gallery-item\"\n    tabindex=\"-1\"\n    :class=\"classesComputed\"\n    :disabled=\"disabled\"\n    :aria-disabled=\"disabled\"\n    @focus=\"onFocus\"\n    @blur=\"onBlur\"\n  >\n    <va-list-item-section v-if=\"removed && undo\">\n      <va-file-upload-undo vertical @recover=\"recoverImage\" />\n    </va-list-item-section>\n    <va-list-item-section v-else>\n      <img\n        v-if=\"previewImage\"\n        :src=\"previewImage\"\n        :alt=\"file.name || ''\"\n        class=\"va-file-upload-gallery-item__image\"\n      >\n      <div class=\"va-file-upload-gallery-item__overlay\">\n        <div\n          class=\"va-file-upload-gallery-item__overlay-background\"\n          :style=\"overlayStylesComputed\"\n        />\n        <div\n          v-if=\"file && file.name\"\n          class=\"va-file-upload-gallery-item__name\"\n          :title=\"file.name\"\n          :style=\"{ color: textColorComputed }\"\n        >\n          {{ file.name }}\n        </div>\n        <va-button\n          v-if=\"!disabled\"\n          flat\n          color=\"danger\"\n          icon=\"va-delete\"\n          class=\"va-file-upload-gallery-item__delete\"\n          :aria-label=\"tp($props.ariaRemoveFileLabel)\"\n          @click=\"removeImage\"\n          @focus=\"onFocus\"\n          @blur=\"onBlur\"\n        />\n      </div>\n    </va-list-item-section>\n  </va-list-item>\n</template>\n\n<script lang=\"ts\">\nimport { onMounted, PropType, ref, watch, computed, toRef } from 'vue'\n\nimport { colorToRgba } from '../../../services/color'\nimport { useFocus, useBem, useStrictInject, useTranslation } from '../../../composables'\n\nimport { VaFileUploadKey, ConvertedFile } from '../types'\nimport { useTextColor } from '../../../composables/useTextColor'\n\nimport { VaButton, VaListItem, VaListItemSection } from '../../index'\nimport { VaFileUploadUndo } from '../VaFileUploadUndo'\n\nconst INJECTION_ERROR_MESSAGE = 'The VaFileUploadGalleryItem component should be used in the context of VaFileUpload component'\n</script>\n\n<script lang=\"ts\" setup>\n\ndefineOptions({\n  name: 'VaFileUploadGalleryItem',\n})\n\nconst props = defineProps({\n  file: { type: Object as PropType<ConvertedFile>, default: null },\n  color: { type: String, default: 'success' },\n\n  ariaRemoveFileLabel: { type: String, default: '$t:removeFile' },\n})\n\nconst emit = defineEmits(['remove'])\n\nconst {\n  undo,\n  disabled,\n  undoDuration,\n} = useStrictInject(VaFileUploadKey, INJECTION_ERROR_MESSAGE)\nconst { isFocused, onFocus, onBlur } = useFocus()\nconst previewImage = ref('')\nconst removed = ref(false)\n\nconst overlayStylesComputed = computed(() => ({\n  backgroundColor: colorToRgba(props.color, 0.7),\n}))\n\nconst classesComputed = useBem('va-file-upload-gallery-item', () => ({\n  notImage: !previewImage.value,\n  focused: isFocused.value,\n  undo: removed.value,\n}))\n\nconst removeImage = () => {\n  if (undo.value) {\n    removed.value = true\n\n    setTimeout(() => {\n      if (!removed.value) { return }\n\n      emit('remove')\n      removed.value = false\n    }, undoDuration.value ?? 0)\n  } else {\n    emit('remove')\n    removed.value = false\n  }\n}\n\nconst recoverImage = () => { removed.value = false }\n\nconst convertToImg = () => {\n  if (!props.file.name || !props.file.image) { return }\n\n  if (props.file.image.url) {\n    previewImage.value = props.file.image.url\n  } else if (props.file.image instanceof File) {\n    const reader = new FileReader()\n\n    reader.readAsDataURL(props.file.image)\n    reader.onload = (e) => {\n      if ((e.target?.result as string).includes('image')) {\n        previewImage.value = e.target?.result as string\n      }\n    }\n  }\n}\n\nonMounted(convertToImg)\nwatch(() => props.file, convertToImg)\n\nconst { t, tp } = useTranslation()\nconst { textColorComputed } = useTextColor(toRef(props, 'color'))\n</script>\n\n<style lang='scss'>\n@import \"variables\";\n@import \"../../../styles/resources\";\n\n$max-image-size: 8.5714rem;\n\n.va-file-upload-gallery-item {\n  display: flex;\n  position: relative;\n  margin-bottom: 1rem;\n  margin-right: 0.5rem;\n  flex-basis: calc(14.2857% - 0.5rem);\n  max-width: calc(14.2857% - 0.5rem);\n  min-width: $max-image-size;\n  border-radius: 0.375rem;\n  overflow: hidden;\n  width: 100%;\n  align-items: stretch;\n\n  @include media-breakpoint-down(md) {\n    flex-basis: calc(16.667% - 0.5rem);\n    max-width: calc(16.667% - 0.5rem);\n  }\n\n  @include media-breakpoint-down(sm) {\n    flex-basis: calc(20% - 0.5rem);\n    max-width: calc(20% - 0.5rem);\n  }\n\n  @include media-breakpoint-down(xs) {\n    flex-basis: calc(50% - 0.5rem);\n    max-width: calc(50% - 0.5rem);\n  }\n\n  &:last-of-type {\n    margin-right: 0;\n  }\n\n  &:hover,\n  &:focus,\n  &--focused {\n    .va-file-upload-gallery-item__overlay {\n      z-index: 3;\n      opacity: 1;\n    }\n\n    .va-file-upload-gallery-item {\n      &__name {\n        color: var(--va-file-upload-gallery-item-text-hover);\n      }\n    }\n  }\n\n  &__overlay {\n    display: flex;\n    position: absolute;\n    height: 100%;\n    width: 100%;\n    top: 0;\n    left: 0;\n    flex-direction: column;\n    padding: 0.5rem;\n    z-index: -1;\n    opacity: 0;\n  }\n\n  &__overlay-background {\n    position: absolute;\n    height: 100%;\n    width: 100%;\n    top: 0;\n    left: 0;\n    z-index: -1;\n  }\n\n  &__image {\n    width: 100%;\n    box-shadow: var(--va-box-shadow);\n    object-fit: cover;\n    z-index: 1;\n  }\n\n  &__name {\n    color: var(--va-file-upload-gallery-item-text);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    font-size: 0.875rem;\n  }\n\n  &__delete {\n    cursor: pointer;\n    font-size: 1.5rem;\n    margin-top: auto;\n  }\n\n  &--not-image {\n    .va-file-upload-gallery-item__overlay {\n      display: flex;\n    }\n  }\n\n  &--undo {\n    .va-list-item__inner {\n      display: flex;\n      align-items: flex-start;\n      position: relative;\n    }\n\n    .va-list-item-section {\n      height: inherit;\n      padding: 0;\n    }\n\n    .va-file-upload-undo {\n      flex: 1;\n    }\n  }\n}\n</style>\n"],"names":[],"mappings":";;;;;;;;;;;;;;AA6DA,MAAM,0BAA0B;;;;;;;;;;;;;AAShC,UAAM,QAAQ;AAOd,UAAM,OAAO;AAEP,UAAA;AAAA,MACJ;AAAA,MACA;AAAA,MACA;AAAA,IAAA,IACE,gBAAgB,iBAAiB,uBAAuB;AAC5D,UAAM,EAAE,WAAW,SAAS,WAAW,SAAS;AAC1C,UAAA,eAAe,IAAI,EAAE;AACrB,UAAA,UAAU,IAAI,KAAK;AAEnB,UAAA,wBAAwB,SAAS,OAAO;AAAA,MAC5C,iBAAiB,YAAY,MAAM,OAAO,GAAG;AAAA,IAC7C,EAAA;AAEI,UAAA,kBAAkB,OAAO,+BAA+B,OAAO;AAAA,MACnE,UAAU,CAAC,aAAa;AAAA,MACxB,SAAS,UAAU;AAAA,MACnB,MAAM,QAAQ;AAAA,IACd,EAAA;AAEF,UAAM,cAAc,MAAM;AACxB,UAAI,KAAK,OAAO;AACd,gBAAQ,QAAQ;AAEhB,mBAAW,MAAM;AACX,cAAA,CAAC,QAAQ,OAAO;AAAE;AAAA,UAAO;AAE7B,eAAK,QAAQ;AACb,kBAAQ,QAAQ;AAAA,QAAA,GACf,aAAa,SAAS,CAAC;AAAA,MAAA,OACrB;AACL,aAAK,QAAQ;AACb,gBAAQ,QAAQ;AAAA,MAClB;AAAA,IAAA;AAGF,UAAM,eAAe,MAAM;AAAE,cAAQ,QAAQ;AAAA,IAAA;AAE7C,UAAM,eAAe,MAAM;AACzB,UAAI,CAAC,MAAM,KAAK,QAAQ,CAAC,MAAM,KAAK,OAAO;AAAE;AAAA,MAAO;AAEhD,UAAA,MAAM,KAAK,MAAM,KAAK;AACX,qBAAA,QAAQ,MAAM,KAAK,MAAM;AAAA,MAC7B,WAAA,MAAM,KAAK,iBAAiB,MAAM;AACrC,cAAA,SAAS,IAAI;AAEZ,eAAA,cAAc,MAAM,KAAK,KAAK;AAC9B,eAAA,SAAS,CAAC,MAAM;;AACrB,gBAAK,OAAE,WAAF,mBAAU,QAAkB,SAAS,OAAO,GAAG;AACrC,yBAAA,SAAQ,OAAE,WAAF,mBAAU;AAAA,UACjC;AAAA,QAAA;AAAA,MAEJ;AAAA,IAAA;AAGF,cAAU,YAAY;AAChB,UAAA,MAAM,MAAM,MAAM,YAAY;AAEpC,UAAM,EAAE,GAAG,GAAG,IAAI,eAAe;AACjC,UAAM,EAAE,kBAAkB,IAAI,aAAa,MAAM,OAAO,OAAO,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}