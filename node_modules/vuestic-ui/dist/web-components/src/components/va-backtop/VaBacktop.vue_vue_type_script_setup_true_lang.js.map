{"version":3,"file":"VaBacktop.vue_vue_type_script_setup_true_lang.js","sources":["../../../../../src/components/va-backtop/VaBacktop.vue"],"sourcesContent":["<template>\n  <div\n    v-if=\"visible\"\n    class=\"va-backtop\"\n    role=\"button\"\n    :aria-label=\"tp($props.ariaLabel)\"\n    tabindex=\"1\"\n    :style=\"computedStyle\"\n    @click=\"scrollToTop\"\n    @keydown.enter.stop=\"scrollToTop\"\n  >\n    <slot>\n      <va-button\n        aria-hidden=\"true\"\n        icon=\"va-arrow-up\"\n        :color=\"color\"\n      />\n    </slot>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { PropType, ref, computed, onMounted, onBeforeUnmount } from 'vue'\nimport { useComponentPresetProp, useTranslation, useNumericProp } from '../../composables'\nimport { VaButton } from '../va-button'\nimport { isServer } from '../../utils/ssr'\nimport { warn } from '../../utils/console'\n\ndefineOptions({\n  name: 'VaBacktop',\n})\n\nconst props = defineProps({\n  ...useComponentPresetProp,\n  target: {\n    type: [Object, String] as PropType<Element | string | undefined>,\n    default: undefined,\n  },\n  visibilityHeight: { type: [Number, String], default: 300 },\n  speed: { type: [Number, String], default: 50 },\n  verticalOffset: { type: String, default: '1rem' },\n  horizontalOffset: { type: String, default: '1rem' },\n  color: { type: String, default: '' },\n  horizontalPosition: {\n    type: String as PropType<'right' | 'left'>,\n    default: 'right',\n    validator: (value: string) => ['right', 'left'].includes(value),\n  },\n  verticalPosition: {\n    type: String as PropType<'bottom' | 'top'>,\n    default: 'bottom',\n    validator: (value: string) => ['bottom', 'top'].includes(value),\n  },\n  ariaLabel: { type: String, default: '$t:backToTop' },\n})\n\nconst targetScrollValue = ref(0)\n\nconst computedStyle = computed(() => ({\n  [props.verticalPosition]: props.verticalOffset,\n  [props.horizontalPosition]: props.horizontalOffset,\n}))\n\nlet targetElement: Element | Window\n\nconst visibilityHeightComputed = useNumericProp('visibilityHeight')\nconst speedComputed = useNumericProp('speed')\n\nconst getTargetElement = (): Element | Window => {\n  if (!props.target) {\n    return window\n  }\n  if (typeof props.target === 'string') {\n    const target = document.querySelector(props.target) as Element\n    if (!target) {\n      warn(`Target element [${props.target}] is not found, falling back to window.`)\n      return window\n    }\n    return target\n  }\n  return props.target as Element\n}\n\nconst scrolled = ref(false)\nconst interval = ref(0)\nconst scrollToTop = () => {\n  if (scrolled.value) { return }\n\n  scrolled.value = true\n\n  if (targetElement instanceof Window) {\n    window.scrollTo({\n      top: 0,\n      behavior: 'smooth',\n    })\n\n    return\n  }\n\n  interval.value = window.setInterval(() => {\n    if (targetElement instanceof Element) {\n      if (targetElement.scrollTop === 0) {\n        clearInterval(interval.value)\n        scrolled.value = false\n      } else {\n        const next = Math.floor(targetElement.scrollTop - speedComputed.value!)\n        targetElement.scrollTo(0, next)\n      }\n    }\n  }, 15)\n}\n\nconst handleScroll = () => {\n  targetScrollValue.value = targetElement instanceof Window\n    ? targetElement.scrollY\n    : targetElement.scrollTop\n}\n\nconst server = isServer()\n\nconst visible = computed(() => {\n  if (server) {\n    return false\n  }\n  return targetScrollValue.value > visibilityHeightComputed.value!\n})\n\nif (!server) {\n  onMounted(() => {\n    targetElement = getTargetElement()\n    targetElement.addEventListener('scroll', handleScroll, true)\n  })\n  onBeforeUnmount(() => targetElement?.removeEventListener('scroll', handleScroll))\n}\n\nconst { tp, t } = useTranslation()\n</script>\n\n<style lang=\"scss\">\n@import \"variables\";\n\n.va-backtop {\n  position: var(--va-backtop-position);\n  top: var(--va-backtop-top);\n  left: var(--va-backtop-left);\n  right: var(--va-backtop-right);\n  bottom: var(--va-backtop-bottom);\n  cursor: var(--va-backtop-cursor);\n  z-index: var(--va-backtop-z-index);\n  font-family: var(--va-font-family);\n}\n</style>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA,UAAM,QAAQ;AAwBR,UAAA,oBAAoB,IAAI,CAAC;AAEzB,UAAA,gBAAgB,SAAS,OAAO;AAAA,MACpC,CAAC,MAAM,gBAAgB,GAAG,MAAM;AAAA,MAChC,CAAC,MAAM,kBAAkB,GAAG,MAAM;AAAA,IAClC,EAAA;AAEE,QAAA;AAEE,UAAA,2BAA2B,eAAe,kBAAkB;AAC5D,UAAA,gBAAgB,eAAe,OAAO;AAE5C,UAAM,mBAAmB,MAAwB;AAC3C,UAAA,CAAC,MAAM,QAAQ;AACV,eAAA;AAAA,MACT;AACI,UAAA,OAAO,MAAM,WAAW,UAAU;AACpC,cAAM,SAAS,SAAS,cAAc,MAAM,MAAM;AAClD,YAAI,CAAC,QAAQ;AACN,eAAA,mBAAmB,MAAM,MAAM,yCAAyC;AACtE,iBAAA;AAAA,QACT;AACO,eAAA;AAAA,MACT;AACA,aAAO,MAAM;AAAA,IAAA;AAGT,UAAA,WAAW,IAAI,KAAK;AACpB,UAAA,WAAW,IAAI,CAAC;AACtB,UAAM,cAAc,MAAM;AACxB,UAAI,SAAS,OAAO;AAAE;AAAA,MAAO;AAE7B,eAAS,QAAQ;AAEjB,UAAI,yBAAyB,QAAQ;AACnC,eAAO,SAAS;AAAA,UACd,KAAK;AAAA,UACL,UAAU;AAAA,QAAA,CACX;AAED;AAAA,MACF;AAES,eAAA,QAAQ,OAAO,YAAY,MAAM;AACxC,YAAI,yBAAyB,SAAS;AAChC,cAAA,cAAc,cAAc,GAAG;AACjC,0BAAc,SAAS,KAAK;AAC5B,qBAAS,QAAQ;AAAA,UAAA,OACZ;AACL,kBAAM,OAAO,KAAK,MAAM,cAAc,YAAY,cAAc,KAAM;AACxD,0BAAA,SAAS,GAAG,IAAI;AAAA,UAChC;AAAA,QACF;AAAA,SACC,EAAE;AAAA,IAAA;AAGP,UAAM,eAAe,MAAM;AACzB,wBAAkB,QAAQ,yBAAyB,SAC/C,cAAc,UACd,cAAc;AAAA,IAAA;AAGpB,UAAM,SAAS;AAET,UAAA,UAAU,SAAS,MAAM;AAC7B,UAAI,QAAQ;AACH,eAAA;AAAA,MACT;AACO,aAAA,kBAAkB,QAAQ,yBAAyB;AAAA,IAAA,CAC3D;AAED,QAAI,CAAC,QAAQ;AACX,gBAAU,MAAM;AACd,wBAAgB,iBAAiB;AACnB,sBAAA,iBAAiB,UAAU,cAAc,IAAI;AAAA,MAAA,CAC5D;AACD,sBAAgB,MAAM,+CAAe,oBAAoB,UAAU,aAAa;AAAA,IAClF;AAEA,UAAM,EAAE,IAAI,EAAE,IAAI,eAAe;;;;;;;;;;;;;;;;;;;;;;;"}